<div class="dashboard-container">
      <!-- Loading State -->
      <app-loading-spinner *ngIf="loading" />
      
      <div *ngIf="!loading" class="dashboard-content">
        <!-- Header Section -->
        <div class="dashboard-header">
          <div class="header-content">
            <div class="brand-section">
              <div class="pdo-logo">
                <span class="logo-text">PDO</span>
              </div>

        <!-- RPA Summary -->
        <div class="rpa-summary-section">
          <div class="rpa-metrics-grid">
            <div class="metric-card green">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.liveProcesses }}</div>
                <div class="metric-title">Live Processes</div>
              </div>
            </div>

            <div class="metric-card yellow">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.inDevelopment }}</div>
                <div class="metric-title">In Development</div>
              </div>
            </div>

            <div class="metric-card blue">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.planned }}</div>
                <div class="metric-title">Planned</div>
              </div>
            </div>

            <div class="metric-card green">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ formatCurrencyShort(stats.valueGenerated) }}</div>
                <div class="metric-title">Value Generated</div>
              </div>
            </div>

            <div class="metric-card purple">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ formatNumber(stats.manhourSavings) }}</div>
                <div class="metric-title">Manhour Savings</div>
              </div>
            </div>

            <div class="metric-card red">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.robots }}</div>
                <div class="metric-title">Robots</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Charts Section -->
        <div class="charts-section">
          <div class="charts-grid">
            <!-- Dollar Savings Chart -->
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">
                  <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                  </svg>
                  Dollar Savings by Directorate
                </h3>
              </div>
              <div class="chart-content">
                <!-- Placeholder for chart -->
                <div class="chart-placeholder">
                  <p>Chart component needed</p>
                  <p>Install ng2-charts or similar chart library</p>
                </div>
                <div class="chart-summary">
                  <div class="total-value">{{ formatCurrencyShort(stats.valueGenerated) }}</div>
                  <div class="total-label">Total Savings</div>
                </div>
              </div>
            </div>

            <!-- Project Status Chart -->
            <div class="chart-card">
              <div class="chart-header">
                <h3 class="chart-title">
                  <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"/>
                  </svg>
                  Project Status by Directorate
                </h3>
              </div>
              <div class="chart-content">
                <!-- Placeholder for chart -->
                <div class="chart-placeholder">
                  <p>Chart component needed</p>
                  <p>Install ng2-charts or similar chart library</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Recognition & Awards -->
        <div class="recognition-section">
          <div class="section-card">
            <div class="section-header">
              <div class="header-info">
                <h3 class="section-title">
                  <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"/>
                  </svg>
                  Recognition & Awards
                </h3>
                <p class="section-subtitle">Outstanding team contributions</p>
              </div>
              <a routerLink="/recognition" class="view-all-link">
                View All ‚Üí
              </a>
            </div>
            
            <div class="section-content">
              <div class="recognition-card">
                <div class="recognition-avatar">
                  <span class="avatar-text">IA</span>
                </div>
                <div class="recognition-info">
                  <h4 class="recipient-name">Istabraq Al Ruhaili</h4>
                  <p class="recipient-team">üèÜ Team</p>
                  <p class="recognition-category">AI Guidance - OQ Engagements</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- IDE Highlights -->
        <div class="ide-highlights-section">
          <div class="section-card">
            <div class="section-header">
              <div class="header-info">
                <h3 class="section-title">
                  <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M13 10V3L4 14h7v7l9-11h-7z"/>
                  </svg>
                  IDE Highlights
                </h3>
              </div>
              <a routerLink="/highlights" class="view-all-link">
                View All ‚Üí
              </a>
            </div>
            
            <div class="section-content">
              <div class="highlights-grid">
                <div *ngFor="let highlight of ideHighlights" 
                     class="highlight-item"
                     (click)="openHighlightModal(highlight)">
                  <div class="highlight-indicator"></div>
                  <div class="highlight-content">
                    <h4 class="highlight-title">{{ highlight.highlightTitle }}</h4>
                    <p class="highlight-description">{{ highlight.description }}</p>
                    <div class="highlight-meta">
                      <span class="highlight-type">{{ highlight.highlightType }}</span>
                      <span class="highlight-date">{{ highlight.highlightDate | date:'MMM d, yyyy' }}</span>
                    </div>
                  </div>
                  <svg class="highlight-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                  </svg>
                </div>
              </div>
              
              <div *ngIf="ideHighlights.length === 0" class="empty-state">
                <svg class="empty-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M13 10V3L4 14h7v7l9-11h-7z"/>
                </svg>
                <p class="empty-message">No highlights available</p>
                <p class="empty-submessage">Recent IDE highlights will appear here</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Team Building Activities -->
        <div class="team-activities-section">
          <div class="section-card">
            <div class="section-header">
              <div class="header-info">
                <h3 class="section-title">
                  <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                  </svg>
                  Team Building Activities
                </h3>
              </div>
              <button *ngIf="authService.isLeader()" 
                      (click)="openAddActivityModal()" 
                      class="add-btn">
                Add Activity
              </button>
            </div>
            
            <div class="section-content">
              <div class="table-container">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Team Name</th>
                      <th>Date</th>
                      <th>Activity Name</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let activity of teamActivities" (click)="openActivityModal(activity)">
                      <td>{{ activity.team?.teamName }}</td>
                      <td>{{ activity.activityDate | date:'MMM d, yyyy' }}</td>
                      <td>{{ activity.activityName }}</td>
                      <td>
                        <span class="status-badge" 
                              [ngClass]="{
                                'status-planning': activity.status === 'Planning',
                                'status-in-progress': activity.status === 'In Progress',
                                'status-done': activity.status === 'Done'
                              }">
                          {{ activity.status }}
                        </span>
                      </td>
                      <td>
                        <button class="action-btn action-view" (click)="openActivityModal(activity); $event.stopPropagation()">
                          View
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
              <div class="title-section">
                <h1 class="main-title">Digital Centre of Excellence</h1>
                <p class="subtitle">DCoE Dashboard - August 2025</p>
              </div>
            </div>
            
            <div class="header-actions">
              <button (click)="refreshDashboard()" class="refresh-btn">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                </svg>
                Refresh
              </button>
              <app-theme-toggle />
            </div>
          </div>
        </div>

        <!-- Overview Metrics -->
        <div class="overview-section">
          <div class="metrics-grid">
            <!-- Metric Cards using native div structure instead of app-metric-card -->
            <div class="metric-card blue" (click)="openMetricDetails('products')">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.totalProducts }}</div>
                <div class="metric-title">Total Products</div>
              </div>
            </div>

            <div class="metric-card green" (click)="openMetricDetails('value')">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ formatCurrency(stats.valueGenerated) }}</div>
                <div class="metric-title">Value Generated</div>
                <div class="metric-trend">+12%</div>
              </div>
            </div>

            <div class="metric-card yellow" (click)="openMetricDetails('percentage')">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v4a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.actualPercentage }}%</div>
                <div class="metric-title">Actual %</div>
                <div class="metric-trend">+5%</div>
              </div>
            </div>

            <div class="metric-card red" (click)="openMetricDetails('engagements')">
              <div class="metric-icon">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                        d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
              </div>
              <div class="metric-content">
                <div class="metric-value">{{ stats.externalEngagements }}</div>
                <div class="metric-title">External Engagements</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Digital Ambition Program -->
        <div class="digital-ambition-section">
          <div class="section-card">
            <div class="section-header">
              <div class="header-info">
                <h3 class="section-title">
                  <svg class="title-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                          d="M13 10V3L4 14h7v7l9-11h-7z"/>
                  </svg>
                  Digital Ambition Program
                </h3>
                <p class="section-subtitle">Program Status Overview</p>
              </div>
            </div>
            
            <div class="section-content">
              <!-- Simple table instead of app-enhanced-table -->
              <div class="table-container">
                <table class="data-table">
                  <thead>
                    <tr>
                      <th>Program Name</th>
                      <th>Phase</th>
                      <th>Comments</th>
                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let program of digitalPrograms" (click)="viewProgram(program)">
                      <td>{{ program.programName }}</td>
                      <td>{{ program.phase }}</td>
                      <td>{{ program.comments }}</td>
                      <td>
                        <span class="status-badge" 
                              [ngClass]="{
                                'status-on-track': program.status === 'On Track',
                                'status-delayed': program.status === 'Delayed by 20%',
                                'status-at-risk': program.status === 'At Risk'
                              }">
                          {{ program.status }}
                        </span>
                      </td>
                      <td>
                        <button class="action-btn action-view" (click)="viewProgram(program); $event.stopPropagation()">
                          View
                        </button>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>